-- 院系表
CREATE TABLE T_AMS_COLLEGE (
  ID   NUMBER(2) PRIMARY KEY,
  NAME VARCHAR2(20) UNIQUE NOT NULL
);
-- 用户表 （教师、学生）
CREATE TABLE T_AMS_USER (
  ID         NUMBER(6) PRIMARY KEY,
  NAME       VARCHAR2(20) NOT NULL UNIQUE,
  REAL_NAME  VARCHAR2(20) NOT NULL,
  PASSWORD   VARCHAR2(20) NOT NULL,
  ROLE       VARCHAR2(10) NOT NULL CHECK (ROLE IN ('student', 'teacher')),
  COLLEGE_ID NUMBER(2) REFERENCES T_AMS_COLLEGE (ID)
);

-- 课程表
CREATE TABLE T_AMS_SUBJECT (
  ID   NUMBER(2) PRIMARY KEY,
  NAME VARCHAR2(20) NOT NULL
);

-- 教师-课程表
CREATE TABLE T_AMS_TEACHER_SUBJECT (
  TID NUMBER(6) REFERENCES T_AMS_USER (ID),
  SID NUMBER(2) REFERENCES T_AMS_SUBJECT (ID),
  PRIMARY KEY (TID, SID)
);

CREATE SEQUENCE T_AMS_USER_SEQ START WITH 144010 INCREMENT BY 1;

INSERT INTO T_AMS_COLLEGE VALUES (10, '软件学院');
INSERT INTO T_AMS_COLLEGE VALUES (20, '计算机学院');
INSERT INTO T_AMS_COLLEGE VALUES (30, '历史学院');

INSERT INTO T_AMS_SUBJECT VALUES (15, 'Core Java');
INSERT INTO T_AMS_SUBJECT VALUES (25, 'Java Web');
INSERT INTO T_AMS_SUBJECT VALUES (35, 'Oracle');
INSERT INTO T_AMS_SUBJECT VALUES (45, 'framework');

INSERT INTO T_AMS_USER VALUES (T_AMS_USER_SEQ.nextval, 'qbj123', '乔保军', '123123', 'teacher', '20');
INSERT INTO T_AMS_USER VALUES (T_AMS_USER_SEQ.nextval, 'zuofang', '左方', '123123', 'teacher', '10');
INSERT INTO T_AMS_USER VALUES (T_AMS_USER_SEQ.nextval, 'yang123', '杨杨', '123123', 'teacher', '30');
INSERT INTO T_AMS_USER VALUES (T_AMS_USER_SEQ.nextval, 'mingming', '渠慎明', '123123', 'teacher', '10');
INSERT INTO T_AMS_USER VALUES (T_AMS_USER_SEQ.nextval, 'liang233', '梁胜斌', '123123', 'teacher', '30');
INSERT INTO T_AMS_USER VALUES (T_AMS_USER_SEQ.nextval, 'huping', '胡萍', '123123', 'teacher', '20');
INSERT INTO T_AMS_USER VALUES (T_AMS_USER_SEQ.nextval, 'dongdong', '冯东栋', '123123', 'teacher', '10');

INSERT INTO T_AMS_TEACHER_SUBJECT VALUES (144039, 15);
INSERT INTO T_AMS_TEACHER_SUBJECT VALUES (144039, 25);
INSERT INTO T_AMS_TEACHER_SUBJECT VALUES (144039, 35);
INSERT INTO T_AMS_TEACHER_SUBJECT VALUES (144040, 15);
INSERT INTO T_AMS_TEACHER_SUBJECT VALUES (144040, 45);
INSERT INTO T_AMS_TEACHER_SUBJECT VALUES (144041, 15);
INSERT INTO T_AMS_TEACHER_SUBJECT VALUES (144041, 35);
INSERT INTO T_AMS_TEACHER_SUBJECT VALUES (144042, 25);
INSERT INTO T_AMS_TEACHER_SUBJECT VALUES (144043, 15);
INSERT INTO T_AMS_TEACHER_SUBJECT VALUES (144043, 35);
INSERT INTO T_AMS_TEACHER_SUBJECT VALUES (144043, 45);
INSERT INTO T_AMS_TEACHER_SUBJECT VALUES (144044, 15);
INSERT INTO T_AMS_TEACHER_SUBJECT VALUES (144045, 15);
INSERT INTO T_AMS_TEACHER_SUBJECT VALUES (144045, 35);
INSERT INTO T_AMS_TEACHER_SUBJECT VALUES (144045, 25);

SELECT *
FROM T_AMS_COLLEGE;
SELECT *
FROM T_AMS_USER;
SELECT *
FROM T_AMS_TEACHER_SUBJECT;

SELECT
  U.ID        userId,
  U.NAME      userName,
  U.REAL_NAME realName,
  U.PASSWORD  password,
  U.ROLE      role,
  C.ID        collegeId,
  C.NAME      collegeName,
  S.ID        subjectId,
  S.NAME      subjectName
FROM T_AMS_USER U LEFT JOIN T_AMS_COLLEGE C ON U.COLLEGE_ID = C.ID
  LEFT JOIN T_AMS_TEACHER_SUBJECT TS ON U.ID = TS.TID
  LEFT JOIN T_AMS_SUBJECT S ON TS.SID = S.ID;


SELECT
  ID,
  NAME
FROM T_AMS_TEACHER_SUBJECT T LEFT JOIN T_AMS_SUBJECT S ON T.SID = S.ID
WHERE T.TID = 144039;

SELECT *
FROM (SELECT
        ID,
        NAME,
        REAL_NAME  realName,
        PASSWORD,
        ROLE,
        COLLEGE_ID collegeId,
        ROWNUM     rn
      FROM T_AMS_USER
      WHERE REAL_NAME LIKE '%%' AND ROLE = 'teacher')
WHERE rn BETWEEN 3 AND 5